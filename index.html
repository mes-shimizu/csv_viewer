<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Viewer</title>
    <!-- Tailwind CSSをCDN経由で読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google FontsからInterフォントを読み込み -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* 日本語フォントと英語フォントの指定 */
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* ファイル入力フィールドを非表示にする */
        #csvFileInput {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <!-- ヘッダーセクション -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">CSV Viewer</h1>
            <p class="mt-2 text-gray-600">CSVファイルをブラウザ上でExcelのように表示します。</p>
        </header>

        <!-- ファイル選択セクション -->
        <div class="max-w-xl mx-auto bg-white rounded-lg shadow-md p-6 mb-8 flex flex-col items-center">
            <!-- カスタムファイル選択ボタン -->
            <label for="csvFileInput" class="cursor-pointer bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition duration-300 ease-in-out shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
                CSVファイルを選択
            </label>
            <!-- 実際のファイル入力フィールド（非表示） -->
            <input type="file" id="csvFileInput" accept=".csv">
            <p id="fileName" class="mt-4 text-sm text-gray-500">ファイルが選択されていません</p>
        </div>

        <!-- テーブル表示セクション -->
        <div id="tableContainer" class="bg-white rounded-lg shadow-md overflow-hidden">
            <!-- テーブルを横スクロール可能にするためのラッパー -->
            <div class="overflow-x-auto">
                <table id="csvTable" class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <!-- ヘッダー行はJavaScriptで動的に生成されます -->
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <!-- データ行はJavaScriptで動的に生成されます -->
                        <tr>
                            <td colspan="7" class="px-6 py-12 text-center text-gray-500">
                                ファイルを選択すると、ここにデータが表示されます。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        // DOM要素を取得
        const csvFileInput = document.getElementById('csvFileInput');
        const fileNameDisplay = document.getElementById('fileName');
        const tableHead = document.querySelector('#csvTable thead');
        const tableBody = document.querySelector('#csvTable tbody');

        // ファイルが選択されたときのイベントリスナー
        csvFileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];

            // ファイルが選択されていない場合は何もしない
            if (!file) {
                fileNameDisplay.textContent = 'ファイルが選択されていません';
                return;
            }

            // ファイル名を表示
            fileNameDisplay.textContent = `選択中のファイル: ${file.name}`;

            // FileReaderのインスタンスを作成
            const reader = new FileReader();

            // ファイルの読み込みが完了したときの処理
            reader.onload = (e) => {
                const text = e.target.result;
                // CSVをパースしてテーブルを更新
                updateTable(text);
            };

            // ファイルをテキストとして読み込む（文字コード: UTF-8）
            // Shift_JISの場合は 'Shift_JIS' に変更してください
            reader.readAsText(file, 'UTF-8');
        });

        /**
         * CSVテキストをパースしてHTMLテーブルを更新する関数
         * @param {string} csvText - 読み込まれたCSVファイルのテキストデータ
         */
        function updateTable(csvText) {
            // テーブルの内容をクリア
            tableHead.innerHTML = '';
            tableBody.innerHTML = '';

            // 改行で各行に分割
            const rows = csvText.trim().split(/\r?\n/);

            // データがない場合は処理を終了
            if (rows.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="7" class="px-6 py-12 text-center text-gray-500">ファイルにデータがありません。</td></tr>`;
                return;
            }

            // 1. ヘッダー行を処理
            const headerRow = document.createElement('tr');
            // CSVの1行目をヘッダーとして取得
            const headers = rows[0].split(',');
            headers.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText.trim();
                // Tailwind CSSクラスを適用してスタイリング
                th.className = 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky top-0 bg-gray-50 z-10';
                headerRow.appendChild(th);
            });
            tableHead.appendChild(headerRow);

            // 2. データ行を処理 (2行目以降)
            const dataRows = rows.slice(1);
            dataRows.forEach(rowText => {
                // 空の行はスキップ
                if (rowText.trim() === '') return;

                const dataRow = document.createElement('tr');
                // 各行をカンマでセルに分割
                const cells = rowText.split(',');
                cells.forEach(cellData => {
                    const td = document.createElement('td');
                    td.textContent = cellData.trim();
                    // Tailwind CSSクラスを適用してスタイリング
                    td.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-800';
                    dataRow.appendChild(td);
                });
                // 行にホバーエフェクトを追加
                dataRow.classList.add('hover:bg-gray-50', 'transition-colors', 'duration-150');
                tableBody.appendChild(dataRow);
            });

            // データがヘッダーのみの場合のメッセージ
            if (dataRows.length === 0 || (dataRows.length === 1 && dataRows[0].trim() === '')) {
                 tableBody.innerHTML = `<tr><td colspan="${headers.length}" class="px-6 py-12 text-center text-gray-500">ヘッダー以外のデータがありません。</td></tr>`;
            }
        }
    </script>

</body>
</html>
